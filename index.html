<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Is It a Scam?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Check if a seller or website is a scam. Community-driven scam reporting.">

<link rel="icon" href="favicon.png.jpg" type="image/png">
<link rel="stylesheet" href="styles.css">

<!-- AI & Compression Libraries -->
<script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nsfwjs@latest/dist/nsfwjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
<style>
  /* Glow effect for returning to grid item */
  .glow-effect {
    animation: pulse-glow 1.5s ease-out;
  }
  @keyframes pulse-glow {
    0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); transform: scale(1); }
    50% { box-shadow: 0 0 20px 5px rgba(139, 92, 246, 0.5); transform: scale(1.02); }
    100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); transform: scale(1); }
  }

  /* --- MODERN GRID STYLES --- */
  .report-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    grid-auto-rows: 12px; /* Granular rows for masonry layout */
    grid-auto-flow: dense; /* Intelligent packing to fill gaps */
    gap: 24px;
    padding: 10px 0;
    align-items: start; /* Prevent items from stretching to row height */
  }
  
  .mini-card {
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 32px; /* Significantly rounded corners */
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    margin-bottom: 0; /* Spacing handled by grid gap */
    height: auto; /* Allow content to dictate height */
  }
  
  .skeleton-card {
    grid-row-end: span 24; /* Default height for skeletons in masonry grid */
  }

  .mini-card:hover {
    transform: translateY(-6px) scale(1.01);
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    border-color: #8b5cf6;
    z-index: 2;
  }

  .mini-card .card-header {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .mini-card .platform-icon {
    width: 48px;
    height: 48px;
    border-radius: 16px; /* Rounded icon container */
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: 24px;
  }
  
  .mini-card .platform-icon svg {
    width: 28px;
    height: 28px;
  }

  .mini-card .card-user {
    font-weight: 700;
    font-size: 1.15rem;
    color: #f0f6fc;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .mini-card .known-as {
    font-size: 0.95rem;
    color: #8b949e;
    line-height: 1.5;
  }

  .mini-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 20px; /* Inner roundness */
    border: 1px solid rgba(255,255,255,0.05);
    transition: transform 0.3s ease;
  }
  
  .mini-card:hover img {
    transform: scale(1.02);
  }

  .mini-card .warning-label {
    display: inline-flex;
    align-items: center;
    font-size: 0.85rem;
    font-weight: 600;
    padding: 8px 16px;
    background: rgba(255,255,255,0.04);
    border-radius: 50px;
    align-self: flex-start;
    margin-top: auto;
  }

  .mini-card .visit-btn, .mini-card .delete-btn {
    margin-top: 10px;
    text-align: center;
    background: #21262d;
    padding: 12px;
    border-radius: 50px; /* Pill shape */
    color: #c9d1d9;
    font-size: 0.95em;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s;
    border: 1px solid rgba(255,255,255,0.1);
    cursor: pointer;
  }

  .mini-card .visit-btn:hover {
    background: #8b5cf6;
    color: white;
    border-color: #8b5cf6;
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
  }
  
  .mini-card .delete-btn {
    background: rgba(255, 77, 77, 0.1);
    color: #ff4d4d;
    border-color: rgba(255, 77, 77, 0.2);
  }
  
  .mini-card .delete-btn:hover {
    background: #ff4d4d;
    color: white;
    border-color: #ff4d4d;
  }

  /* --- PHONE NUMBER CARD VARIANT --- */
  .mini-card.phone-card {
    background: linear-gradient(145deg, #161b22, #1c2128);
    border-color: #30363d;
    padding: 20px;
  }
  
  .mini-card.phone-card .phone-number {
    font-family: 'Courier New', Courier, monospace;
    font-size: 1.3rem;
    font-weight: 700;
    color: #fff;
    letter-spacing: 0.5px;
  }
  
  .mini-card.phone-card .location-badge {
    font-size: 0.85rem;
    color: #8b949e;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  /* --- INPUT WITH PREFIX (Phone Selector) --- */
  .input-with-prefix {
    display: flex;
    gap: 8px;
    align-items: center;
    width: 100%;
  }
  .input-with-prefix input {
    flex: 1;
  }
  .country-prefix {
    background: #0d1117;
    border: 1px solid #30363d;
    color: #c9d1d9;
    padding: 12px;
    border-radius: 6px;
    outline: none;
    cursor: pointer;
    height: 45px; /* Match standard input height */
    font-size: 1rem;
    max-width: 100px;
  }
  .country-prefix.hidden {
    display: none;
  }

  /* --- VERIFIED USER BADGE --- */
  .verified-user-badge {
    color: #38bdf8; /* Light Blue */
    display: inline-flex;
    align-items: center;
    margin-left: 4px;
  }

  /* --- BANNED UI STATES --- */
  .floating-pill-btn.banned-fab {
    background: #ff4d4d !important;
    border-color: #ff4d4d !important;
    box-shadow: 0 4px 15px rgba(255, 77, 77, 0.4);
    animation: pulse-red 2s infinite;
  }
  
  .notification-btn.banned-bell svg {
    fill: #ff4d4d !important;
  }
  @keyframes pulse-red {
    0% { box-shadow: 0 0 0 0 rgba(255, 77, 77, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(255, 77, 77, 0); }
    100% { box-shadow: 0 0 0 0 rgba(255, 77, 77, 0); }
  }

  /* --- DELETION COUNTDOWN TOAST --- */
  .undo-toast {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 12px;
    padding: 0;
    z-index: 10000;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    overflow: hidden;
    min-width: 320px;
    display: flex;
    flex-direction: column;
  }
  .undo-content {
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    color: #f0f6fc;
    font-size: 0.95rem;
  }
  .undo-progress-bar {
    height: 3px;
    background: #30363d;
    width: 100%;
  }
  #undo-progress {
    height: 100%;
    background: #ff4d4d;
    width: 100%;
  }
</style>
</head>

<body>

<!-- =====================
     NAVBAR
===================== -->
<header class="navbar">
  <button class="hamburger-btn" onclick="toggleMenu()">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <div class="logo">
    <img src="IMG_3043.PNG" alt="IsItAScam">
  </div>
  <nav>
    <!-- NOTIFICATIONS -->
    <div class="notification-wrapper">
      <button class="notification-btn" onclick="toggleNotifications()">
        <svg viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg>
        <span id="notification-badge" class="notification-badge hidden">0</span>
      </button>
      <div id="notification-dropdown" class="notification-dropdown hidden">
        <div style="display:flex; justify-content:space-between; align-items:center; padding:12px 16px; border-bottom:1px solid #30363d; background:#161b22; position:sticky; top:0; z-index:10;">
            <span style="font-weight:bold; color:#f0f6fc; font-size:0.95rem;">Notifications</span>
            <button onclick="toggleNotifications()" style="background:none; border:none; color:#8b949e; cursor:pointer; padding:4px; display:flex; align-items:center; justify-content:center; border-radius:4px;">
                <svg viewBox="0 0 24 24" style="width:20px; height:20px; fill:currentColor;"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
        </div>
        <div id="notification-list"></div>
      </div>
    </div>
    <a href="#" onclick="showPage('home')" style="display: flex; align-items: center; gap: 6px;">
      <svg viewBox="0 0 24 24" style="width: 20px; height: 20px; fill: currentColor;"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      Home
    </a>
    <a href="#" id="nav-login" onclick="showPage('login')">Login</a>
  </nav>
</header>

<!-- =====================
     HOME PAGE
===================== -->
<section id="home">
  <div class="hero">
    <h1>Before You Buy, Ask One Question</h1>
    <h2>Is it a scam?</h2>

    <div class="search-box">
      <input type="text" id="search-input" placeholder="Website, username, phone number..." onkeyup="if(event.key === 'Enter') performSearch()">
      <button id="clear-search-btn" class="hidden" onclick="clearSearch()">‚úï</button>
      <button onclick="performSearch()">
        <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; fill: currentColor;"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
      </button>
    </div>

    <p style="margin-top:20px; opacity:0.7;">
      Results are based on community reports and public data.
    </p>
  </div>

  <hr class="section-separator">

  <!-- SEARCH RESULTS LABEL -->
  <h2 id="search-results-label" class="hidden" style="text-align: center; margin-bottom: 20px; color: #8b5cf6;">Search Results</h2>

  <!-- HOME PAGE TABS -->
  <div class="home-tab-selector">
    <button class="home-tab-btn active" id="home-reports-tab-btn" onclick="switchHomeTab('reports')">Community Reports</button>
    <button class="home-tab-btn" id="home-ratings-tab-btn" onclick="switchHomeTab('ratings')">Seller Ratings</button>
    <div class="tab-indicator" id="home-tab-indicator"></div>
  </div>

  <!-- Sort Filter -->
  <div style="max-width: 1000px; margin: 0 auto 15px; padding: 10px 20px; display: flex; justify-content: flex-start; position: sticky; top: 85px; z-index: 900; background: rgba(15, 17, 21, 0.85); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-radius: 12px;">
    <select id="sort-filter" onchange="handleSortChange()" style="background-color: #161b22; border: 1px solid #30363d; color: #eaeaea; padding: 8px 36px 8px 12px; border-radius: 8px; outline: none; cursor: pointer; font-size: 0.9rem; width: auto; margin: 0;">
      <option value="trending">üî• Trending</option>
      <option value="recent">üïí Most Recent</option>
      <option value="risk">‚ö†Ô∏è Highest Risk</option>
    </select>
  </div>

  <!-- Reports Grid -->
  <div id="local-reports-grid" class="report-grid"></div>
  <div id="reports-load-more-container" class="hidden" style="text-align: center; margin-top: 20px; margin-bottom: 40px;">
    <button onclick="loadMoreReports()" class="visit-btn" style="width: auto; padding: 12px 30px; background: #21262d; border: 1px solid #30363d;">Load More</button>
  </div>

  <!-- Ratings Grid -->
  <div id="local-ratings-grid" class="report-grid hidden"></div>
</section>

<!-- =====================
     DETAILS VIEW
===================== -->
<section id="details-view" class="hidden">
  <div class="content-container">
    <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <h1 id="details-title" style="word-break: break-all;">Details</h1>
    <div id="details-list"></div>
  </div>
</section>

<!-- =====================
     PROFILE PAGE
===================== -->
<section id="profile" class="hidden">
  <div class="content-container">
    <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <h1>instagram.com/shop_example</h1>
    <p class="risk-high">Trust Score: 23 / 100</p>

    <div class="card">
      <strong>Paid, No Delivery</strong>
      <p>User paid via D17 and got blocked.</p>
    </div>

    <button onclick="showPage('report')">Rate or Report</button>
  </div>
</section>

<!-- =====================
     REPORT PAGE
===================== -->
<section id="report" class="hidden">
  <div class="content-container">
    <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <!-- TABS -->
    <div class="tab-container">
      <button class="tab-btn active" onclick="switchTab('rate')" id="tab-rate">
        <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
        Rate Seller
      </button>
      <button class="tab-btn" onclick="switchTab('scam')" id="tab-scam">
        <svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
        Report Scam
      </button>
    </div>

    <!-- RATE FORM -->
    <form id="form-rate">
      <h1>Rate a Seller</h1>
      <div class="input-with-prefix">
        <select id="rate-country-select" class="country-prefix hidden"></select>
        <input type="text" id="rate-link" placeholder="Link / username / phone" required oninput="handleInput('rate-link', 'rate-preview')">
      </div>
      <div id="rate-preview" class="hidden"></div>

      <div class="rating-container">
        <span class="rating-label">Select Rating</span>
        <div class="rating-wrapper">
          <span class="star" onclick="setRating(1)">‚òÖ</span>
          <span class="star" onclick="setRating(2)">‚òÖ</span>
          <span class="star" onclick="setRating(3)">‚òÖ</span>
          <span class="star" onclick="setRating(4)">‚òÖ</span>
          <span class="star" onclick="setRating(5)">‚òÖ</span>
        </div>
      </div>
      <input type="hidden" id="rating-input" value="0">

      <div class="form-grid">
        <textarea id="rate-good" placeholder="What was good? (e.g. Fast delivery)" rows="3"></textarea>
        <textarea id="rate-bad" placeholder="What was bad? (e.g. Packaging)" rows="3"></textarea>
      </div>

      <button type="button" onclick="submitRating()" class="submit-btn">Submit Rating</button>
    </form>

    <!-- SCAM REPORT FORM -->
    <form id="form-scam" class="hidden" onsubmit="event.preventDefault(); submitReport()">
      <h1>Report a Scam</h1>
      <p>Help the community stay safe by reporting suspicious activity.</p>

      <div class="input-with-prefix">
        <select id="scam-country-select" class="country-prefix hidden"></select>
        <input type="text" id="scammer-link" placeholder="Link / username / phone" required oninput="handleInput('scammer-link', 'link-preview')">
      </div>
      <div id="link-preview" class="hidden"></div>

      <input type="text" id="scammer-name" placeholder="Display Name (e.g. Shop Name)" required>

      <textarea id="scammer-desc" placeholder="Describe what happened..." rows="4" required></textarea>

      <div class="file-upload-wrapper">
        <input type="file" id="scammer-pic" accept="image/*" onchange="previewImage(this)" class="hidden-file-input">
        <label for="scammer-pic" class="file-upload-label">
          <svg viewBox="0 0 24 24" style="width: 32px; height: 32px; margin-bottom: 8px; fill: currentColor;"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-5-7l-3 3.72L9 13l-3 4h12l-4-5z"/></svg>
          <span>Upload Proof (Optional)</span>
        </label>
      </div>

      <div id="upload-preview-container" class="hidden" style="margin-bottom: 15px; text-align: center;">
        <img id="upload-preview" src="" alt="Preview" style="max-width: 100%; max-height: 200px; border-radius: 8px; border: 1px solid #30363d;">
      </div>

      <button type="submit" class="submit-btn">Submit Report</button>

    </form>
  </div>
</section>

<!-- =====================
     ADMIN DASHBOARD
===================== -->
<section id="admin-dashboard" class="hidden">
  <div class="content-container">
    <button class="back-btn" onclick="handleBackClick('login')" ondblclick="handleBackClick('login', true)">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <h1>Admin Dashboard</h1>
    <p id="admin-dashboard-subtitle">Manage verified community members.</p>
    
    <!-- Admin Search -->
    <div class="search-box" style="margin: 0 0 20px 0; max-width: 100%;">
        <input type="text" id="admin-search-input" placeholder="Search by Name or UID..." onkeyup="filterAdminList()" style="background:#0d1117;">
    </div>

    <!-- Admin Tabs -->
    <div class="home-tab-selector" style="margin-top: 0; margin-bottom: 20px;">
      <button class="home-tab-btn active" id="admin-verified-tab-btn" onclick="switchAdminTab('verified')">Verified Users</button>
      <button class="home-tab-btn" id="admin-banned-tab-btn" onclick="switchAdminTab('banned')">Banned Users</button>
      <div class="tab-indicator" id="admin-tab-indicator"></div>
    </div>

    <!-- Verified Section -->
    <div id="admin-verified-section">
        <div class="mini-card" style="margin-bottom: 20px; border-color: #8b5cf6;">
            <h3 style="margin: 0 0 15px 0;">Manually Verify User</h3>
            <input type="text" id="admin-verify-uid" placeholder="User UID (Required)" style="width:100%; margin-bottom:10px; padding:10px; background:#0d1117; border:1px solid #30363d; color:white; border-radius:6px; outline:none;">
            <input type="text" id="admin-verify-name" placeholder="Display Name (Optional)" style="width:100%; margin-bottom:10px; padding:10px; background:#0d1117; border:1px solid #30363d; color:white; border-radius:6px; outline:none;">
            <button onclick="manualVerifyUser()" class="visit-btn" style="width:100%;">Grant Verification</button>
        </div>
        <div id="admin-user-list" class="report-grid"></div>
    </div>

    <!-- Banned Section -->
    <div id="admin-banned-section" class="hidden">
        <div class="mini-card" style="margin-bottom: 20px; border-color: #ff4d4d;">
            <h3 style="margin: 0 0 15px 0; color: #ff4d4d;">Manually Ban User</h3>
            <input type="text" id="admin-ban-uid" placeholder="User UID (Required)" style="width:100%; margin-bottom:10px; padding:10px; background:#0d1117; border:1px solid #30363d; color:white; border-radius:6px; outline:none;">
            <input type="text" id="admin-ban-name" placeholder="Display Name (Optional)" style="width:100%; margin-bottom:10px; padding:10px; background:#0d1117; border:1px solid #30363d; color:white; border-radius:6px; outline:none;">
            <input type="text" id="admin-ban-reason" placeholder="Reason for ban (e.g. Spamming)" style="width:100%; margin-bottom:10px; padding:10px; background:#0d1117; border:1px solid #30363d; color:white; border-radius:6px; outline:none;">
            <button onclick="manualBanUser()" class="visit-btn" style="width:100%; background: rgba(255, 77, 77, 0.1); color: #ff4d4d; border-color: #ff4d4d;">Ban User</button>
        </div>
        <div id="admin-banned-list" class="report-grid"></div>
    </div>
  </div>
</section>

<!-- =====================
     LOGIN PAGE
===================== -->
<section id="login" class="hidden">
  <div class="content-container">
    <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <!-- TABS (Visible when logged in) -->
    <div id="profile-tabs" class="tab-container hidden" style="margin-bottom: 20px;">
      <button class="tab-btn active" id="profile-tab-btn" onclick="switchProfileTab('profile')">
        <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        Profile
      </button>
      <button class="tab-btn" id="activity-tab-btn" onclick="switchProfileTab('activity')">
        <svg viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>
        Activity
      </button>
    </div>

    <div class="auth-container">
      <h1>Login</h1>
      <p>Sign in to submit and track reports.</p>

      <button class="google-btn" onclick="googleLogin()">
        Continue with Google
      </button>

      <small style="opacity:0.6;">
        Firebase authentication will be added later.
      </small>
    </div>

  <!-- ACTIVITY SECTION (Visible when logged in) -->
  <div id="user-activity-section" class="hidden" style="margin-top: 40px;">
    <h1 style="text-align: center;">My Activity</h1>
    
    <div class="home-tab-selector">
      <button class="home-tab-btn active" id="activity-reports-tab-btn" onclick="switchActivityTab('reports')">
        <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
        <span>My Reports</span>
      </button>
      <button class="home-tab-btn" id="activity-ratings-tab-btn" onclick="switchActivityTab('ratings')">
        <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
        <span>My Ratings</span>
      </button>
      <div class="tab-indicator" id="activity-tab-indicator"></div>
    </div>

    <div id="activity-reports" class="report-grid"></div>
    <div id="activity-ratings" class="report-grid hidden"></div>
  </div>
  </div>
</section>

<!-- FLOATING ACTION BUTTON -->
<button class="floating-pill-btn" onclick="handleFabClick()">
  <span class="fab-content-report">
    <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
    <span>Report</span>
  </span>
  <span class="fab-content-up">
    <svg viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg>
  </span>
</button>

<!-- DELETION COUNTDOWN TOAST -->
<div id="undo-toast" class="undo-toast hidden">
  <div class="undo-content">
    <span id="undo-message">Deleting in 3s...</span>
    <button onclick="cancelDeletion()" class="visit-btn" style="margin:0; padding:6px 16px; font-size:0.85rem; background:#30363d; border:none; color:#58a6ff;">Cancel</button>
  </div>
  <div class="undo-progress-bar"><div id="undo-progress"></div></div>
</div>

<!-- =====================
     FULLSCREEN MENU OVERLAY
===================== -->
<div id="fullscreen-menu" class="fullscreen-menu">
  <div class="menu-content">
    <h1 style="display: flex; align-items: center; justify-content: center; gap: 10px;">
      <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill:#8b949e;"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
      About Us
    </h1>
    <p>IsItAScam is a community-driven platform dedicated to identifying and reporting online scams. Our mission is to create a safer digital environment by sharing real user experiences.</p>
    
    <div class="menu-links">
      <a href="#" onclick="showPage('privacy'); closeMenu()" style="display:inline-flex; align-items:center; gap:8px;">
        <svg viewBox="0 0 24 24" style="width:20px; height:20px; fill:currentColor;"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
        Privacy Policy
      </a>
      <a href="#" onclick="showPage('terms'); closeMenu()" style="display:inline-flex; align-items:center; gap:8px;">
        <svg viewBox="0 0 24 24" style="width:20px; height:20px; fill:currentColor;"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
        Terms of Service
      </a>
      <a href="#" style="display:inline-flex; align-items:center; gap:8px;">
        <svg viewBox="0 0 24 24" style="width:20px; height:20px; fill:currentColor;"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
        Contact Support
      </a>
    </div>

    <div class="social-icons">
      <a href="#" class="social-link twitter">
        <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
        Twitter / X
      </a>
      <a href="#" class="social-link instagram">
        <svg viewBox="0 0 24 24"><path d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 3.8 7.6v8.8A3.6 3.6 0 0 0 7.6 20h8.8a3.6 3.6 0 0 0 3.8-3.8V7.6A3.6 3.6 0 0 0 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg>
        Instagram
      </a>
      <a href="#" class="social-link facebook">
        <svg viewBox="0 0 24 24"><path d="M12 2.04C6.5 2.04 2.54 6.5 2.54 12c0 4.97 3.63 9.11 8.44 9.88v-7.03h-2.54v-2.85h2.54V9.75c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.19 2.23.19v2.47h-1.26c-1.24 0-1.65.77-1.65 1.56v1.88h2.76l-.44 2.85h-2.32v7.03c4.81-.77 8.44-4.91 8.44-9.88 0-5.5-4.46-9.96-9.96-9.96z"/></svg>
        Facebook
      </a>
    </div>
  </div>
</div>

<!-- =====================
     PRIVACY POLICY
===================== -->
<section id="privacy" class="hidden">
  <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
    <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
  </button>
  <div class="legal-content">
    <h1>Privacy Policy</h1>
    <p>Last updated: October 2023</p>
    
    <h2>1. Information We Collect</h2>
    <p>We collect information you provide directly to us, such as when you submit a report, rate a seller, or log in via Google. This includes your display name, email address (used for authentication and account management), and the content of your reports.</p>
    
    <h2>2. How We Use Your Information</h2>
    <p>We use this information to operate and maintain IsItAScam, display community reports to other users, and prevent abuse of our platform. We do not sell your personal data to third parties.</p>
    
    <h2>3. Public Content</h2>
    <p>Any reports, ratings, or comments you submit are public. Please do not include your own private sensitive information (like your home address or phone number) in the body of your reports.</p>
  </div>
</section>

<!-- =====================
     TERMS OF SERVICE
===================== -->
<section id="terms" class="hidden">
  <button class="back-btn" onclick="handleBackClick('home')" ondblclick="handleBackClick('home', true)">
    <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
  </button>
  <div class="legal-content">
    <h1>Terms of Service</h1>
    <p>By accessing IsItAScam, you agree to be bound by these terms. These rules are designed to protect the community and ensure the platform remains useful.</p>
    
    <h2>1. User Conduct & Rules</h2>
    <ul>
      <li><strong>No Fake Reports:</strong> You must only submit reports based on genuine interactions. Submitting false claims to harm a reputation is strictly prohibited.</li>
      <li><strong>No Spam:</strong> Do not post repetitive content, advertisements, or promotional links.</li>
      <li><strong>No Harassment:</strong> Do not use this platform to bully, harass, or threaten individuals.</li>
      <li><strong>No Doxxing:</strong> Do not post private personal information (like home addresses) of individuals who are not operating as a public business.</li>
    </ul>

    <h2>2. Content Disclaimer</h2>
    <p>All content is user-generated. IsItAScam does not verify the accuracy of reports and is not liable for any damages resulting from the use of this information. Users are responsible for their own submissions.</p>

    <h2>3. Termination</h2>
    <p>We reserve the right to ban users and delete content that violates these terms at our sole discretion.</p>

    <h2>4. Liability</h2>
    <p>IsItAScam is provided "as is" without any warranties. We are not responsible for any disputes between users and sellers.</p>
  </div>
</section>

<!-- =====================
     FOOTER
===================== -->
<footer>
  <p>¬© 2025 IsItAScam</p>
  <p>Community reports ‚Äì unverified claims</p>
</footer>

<!-- =====================
     JAVASCRIPT
===================== -->
<script type="module" src="script.js"></script>
<script>
  // Logic to prevent page reload on back and highlight the last viewed item

  // 2. Override handleBackClick to switch views without reloading
  window.addEventListener('load', () => {
    window.handleBackClick = function(targetId, forceExit = false) {
      // Restore original scroll-to-top behavior
      if (!forceExit && window.scrollY > 50) {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        return;
      }

      // Closing Animation Logic
      const detailsView = document.getElementById('details-view');
      const card = window.lastClickedGridItem;
      const isDetailsOpen = !detailsView.classList.contains('hidden');
      
      // Determine where to return (Home, Login/Activity, Admin)
      const returnPageId = window.lastActivePage || 'home';

      if (isDetailsOpen && card) {
          // 1. Prepare for animation
          // Make sure previous section is visible behind
          const targetSection = document.getElementById(returnPageId);
          if (targetSection) targetSection.classList.remove('hidden');
          
          // Restore Tabs if returning to Activity/Profile
          if (returnPageId === 'login' && window.lastProfileTab === 'activity') {
              const activitySection = document.getElementById('user-activity-section');
              const profileContent = document.querySelector('.auth-container');
              const profileTabs = document.getElementById('profile-tabs');
              
              if (profileTabs) profileTabs.classList.remove('hidden');
              if (activitySection) activitySection.classList.remove('hidden');
              if (profileContent) profileContent.classList.add('hidden');
              
              // Restore Sub-tab (Reports vs Ratings)
              const reportsGrid = document.getElementById('activity-reports');
              const ratingsGrid = document.getElementById('activity-ratings');
              const repBtn = document.getElementById('activity-reports-tab-btn');
              const rateBtn = document.getElementById('activity-ratings-tab-btn');
              
              if (window.lastActivitySubTab === 'ratings') {
                  if (reportsGrid) reportsGrid.classList.add('hidden');
                  if (ratingsGrid) ratingsGrid.classList.remove('hidden');
                  if (repBtn) repBtn.classList.remove('active');
                  if (rateBtn) rateBtn.classList.add('active');
              } else {
                  if (reportsGrid) reportsGrid.classList.remove('hidden');
                  if (ratingsGrid) ratingsGrid.classList.add('hidden');
                  if (repBtn) repBtn.classList.add('active');
                  if (rateBtn) rateBtn.classList.remove('active');
              }
              
              // Update Main Tab Buttons
              const actBtn = document.getElementById('activity-tab-btn');
              const profBtn = document.getElementById('profile-tab-btn');
              if (actBtn) actBtn.classList.add('active');
              if (profBtn) profBtn.classList.remove('active');
              
              // Trigger grid resize & indicator update
              if (window.resizeAllGridItems) setTimeout(window.resizeAllGridItems, 0);
              if (window.updateTabIndicator) requestAnimationFrame(window.updateTabIndicator);
          }
          
          // Force layout flush to ensure the browser acknowledges Home is visible
          if (targetSection) void targetSection.offsetWidth;
          
          // Ensure FAB is visible when returning to home
          const fab = document.querySelector('.floating-pill-btn');
          if (fab) {
              if (returnPageId === 'home') fab.classList.remove('hidden-fab');
              else fab.classList.add('hidden-fab');
          }
          
          // Restore exact scroll position so card is in correct place for target calculation
          if (typeof window.lastGridScrollY === 'number') {
              window.scrollTo({ top: window.lastGridScrollY, behavior: 'auto' });
          }
          
          // Use stored rect to ensure animation targets the exact screen position where it started
          const rect = window.lastGridItemRect || (card ? card.getBoundingClientRect() : null);
          
          if (!rect) {
              // Fallback if something went wrong: just switch views
              detailsView.classList.add('hidden');
              return;
          }

          // Prepare Clone for Closing Animation
          const cloneContainer = document.getElementById('card-clone-container');
          const innerContent = detailsView.querySelector('.content-container');
          
          // Swap visibility: Hide Content, Show Clone
          if (innerContent) {
              innerContent.style.width = window.innerWidth + 'px';
              innerContent.style.transition = 'opacity 0.2s ease';
              innerContent.style.opacity = '0';
          }
          
          if (cloneContainer) {
              cloneContainer.style.display = 'flex';
              cloneContainer.style.opacity = '0';
              
              // Hide text elements in clone to prevent glitchy reflow
              Array.from(cloneContainer.children).forEach(child => {
                  if (child.tagName !== 'IMG') {
                      child.style.transition = 'opacity 0.2s ease';
                      child.style.opacity = '0';
                  }
              });

              void cloneContainer.offsetWidth; // Reflow
              cloneContainer.style.transition = 'opacity 0.2s ease';
              cloneContainer.style.opacity = '1';
          }

          // Lock Details View dimensions
          Object.assign(detailsView.style, {
              position: 'fixed',
              top: '0',
              left: '0',
              width: '100%',
              height: '100%',
              zIndex: '9999',
              overflow: 'hidden',
              backgroundColor: '#161b22', // Match card bg
              transition: 'top 0.5s cubic-bezier(0.19, 1, 0.22, 1), left 0.5s cubic-bezier(0.19, 1, 0.22, 1), width 0.5s cubic-bezier(0.19, 1, 0.22, 1), height 0.5s cubic-bezier(0.19, 1, 0.22, 1), border-radius 0.5s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease 0.2s'
          });

          // 2. Animate back to Card
          requestAnimationFrame(() => {
              requestAnimationFrame(() => {
                  Object.assign(detailsView.style, {
                      top: rect.top + 'px',
                      left: rect.left + 'px',
                      width: rect.width + 'px',
                      height: rect.height + 'px',
                      borderRadius: getComputedStyle(card).borderRadius,
                      opacity: '0',
                      transform: 'none'
                  });
              });
          });

          // 3. Cleanup after animation
          setTimeout(() => {
              detailsView.classList.add('hidden');
              detailsView.style = ''; // Reset styles
              if (innerContent) innerContent.style.width = '';
              if (cloneContainer) cloneContainer.style.display = 'none';
              
              // Re-apply glow
              card.classList.add('glow-effect');
              setTimeout(() => {
                  card.classList.remove('glow-effect');
                  window.lastClickedGridItem = null;
              }, 1500);
          }, 600);
          
          return; // Stop standard execution
      }

      // Hide all sections
      document.querySelectorAll('section').forEach(el => el.classList.add('hidden'));
      // Show target section
      const target = document.getElementById(targetId);
      if (target) target.classList.remove('hidden');
      
      // Handle FAB visibility
      const fab = document.querySelector('.floating-pill-btn');
      if (fab) {
        if (targetId === 'home') fab.classList.remove('hidden-fab');
        else fab.classList.add('hidden-fab');
      }

      // Restore position and glow
      if (targetId === 'home' && window.lastClickedGridItem) {
        window.lastClickedGridItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
        window.lastClickedGridItem.classList.add('glow-effect');
        setTimeout(() => {
            if (window.lastClickedGridItem) window.lastClickedGridItem.classList.remove('glow-effect');
            window.lastClickedGridItem = null;
        }, 1500);
      }
    };
  });
</script>

</body>
</html>
